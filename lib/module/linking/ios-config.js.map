{"version":3,"names":["fs","path","IOSConfigManager","configurePodfile","projectRoot","moduleConfig","podfilePath","findPodfile","success","message","error","content","readFileSync","isAlreadyConfigured","modifiedFiles","modifiedContent","modifyPodfileContent","backupPath","writeFileSync","basename","Error","String","iosPath","join","existsSync","podPattern","RegExp","name","test","iosDir","relativePath","relative","modulePath","podStatement","targetRegex","match","targetContent","newTargetContent","replace","podRegex","pods","length","lastPod","lastPodIndex","lastIndexOf","insertIndex","slice","validateIOSProject","getPodfileInfo","exists","exec","push","manager"],"sources":["ios-config.js"],"sourcesContent":["import * as fs from 'fs';\nimport * as path from 'path';\nexport class IOSConfigManager {\n    /**\n     * Configures Podfile to include the native module pod\n     */\n    configurePodfile(projectRoot, moduleConfig) {\n        try {\n            const podfilePath = this.findPodfile(projectRoot);\n            if (!podfilePath) {\n                return {\n                    success: false,\n                    message: 'Podfile not found',\n                    error: 'Could not locate Podfile in iOS project directory'\n                };\n            }\n            const content = fs.readFileSync(podfilePath, 'utf8');\n            // Check if already configured\n            if (this.isAlreadyConfigured(content, moduleConfig)) {\n                return {\n                    success: true,\n                    message: 'Podfile already configured',\n                    modifiedFiles: []\n                };\n            }\n            const modifiedContent = this.modifyPodfileContent(content, moduleConfig, projectRoot);\n            // Create backup\n            const backupPath = `${podfilePath}.backup`;\n            fs.writeFileSync(backupPath, content);\n            // Write modified content\n            fs.writeFileSync(podfilePath, modifiedContent);\n            return {\n                success: true,\n                message: `Successfully configured ${path.basename(podfilePath)}`,\n                modifiedFiles: [podfilePath]\n            };\n        }\n        catch (error) {\n            return {\n                success: false,\n                message: 'Failed to configure Podfile',\n                error: error instanceof Error ? error.message : String(error)\n            };\n        }\n    }\n    /**\n     * Finds the Podfile in the iOS project\n     */\n    findPodfile(projectRoot) {\n        const iosPath = path.join(projectRoot, 'ios');\n        if (!fs.existsSync(iosPath)) {\n            return null;\n        }\n        const podfilePath = path.join(iosPath, 'Podfile');\n        if (fs.existsSync(podfilePath)) {\n            return podfilePath;\n        }\n        return null;\n    }\n    /**\n     * Checks if the Podfile is already configured with the module\n     */\n    isAlreadyConfigured(content, moduleConfig) {\n        // Look for pod reference with the module name\n        const podPattern = new RegExp(`pod\\\\s+['\"]${moduleConfig.name}['\"]`);\n        return podPattern.test(content);\n    }\n    /**\n     * Modifies the Podfile content to include the module pod\n     */\n    modifyPodfileContent(content, moduleConfig, projectRoot) {\n        // Calculate relative path from iOS directory to module\n        const iosDir = path.join(projectRoot, 'ios');\n        const relativePath = path.relative(iosDir, moduleConfig.modulePath);\n        // Create pod statement with path\n        const podStatement = `  pod '${moduleConfig.name}', :path => '${relativePath}'`;\n        // Find the target block to add the pod to\n        const targetRegex = /target\\s+['\"][^'\"]+['\"]\\s+do([\\s\\S]*?)end/;\n        const match = content.match(targetRegex);\n        if (match) {\n            // Add pod to the target block\n            const targetContent = match[1];\n            const newTargetContent = targetContent + '\\n' + podStatement + '\\n';\n            const modifiedContent = content.replace(match[0], match[0].replace(targetContent, newTargetContent));\n            return modifiedContent;\n        }\n        else {\n            // If no target block found, try to find a general location to add the pod\n            // Look for existing pod statements and add after them\n            const podRegex = /pod\\s+['\"][^'\"]+['\"][^\\n]*\\n/g;\n            const pods = content.match(podRegex);\n            if (pods && pods.length > 0) {\n                const lastPod = pods[pods.length - 1];\n                const lastPodIndex = content.lastIndexOf(lastPod);\n                const insertIndex = lastPodIndex + lastPod.length;\n                return content.slice(0, insertIndex) +\n                    podStatement + '\\n' +\n                    content.slice(insertIndex);\n            }\n            else {\n                // If no pods found, add at the end of the file\n                return content + '\\n' + podStatement + '\\n';\n            }\n        }\n    }\n    /**\n     * Validates that the iOS project structure is ready for pod configuration\n     */\n    validateIOSProject(projectRoot) {\n        const iosPath = path.join(projectRoot, 'ios');\n        if (!fs.existsSync(iosPath)) {\n            return {\n                success: false,\n                message: 'iOS project directory not found',\n                error: `Directory not found: ${iosPath}`\n            };\n        }\n        const podfilePath = path.join(iosPath, 'Podfile');\n        if (!fs.existsSync(podfilePath)) {\n            return {\n                success: false,\n                message: 'Podfile not found',\n                error: `Podfile not found at: ${podfilePath}`\n            };\n        }\n        // Check if Podfile is readable\n        try {\n            fs.readFileSync(podfilePath, 'utf8');\n        }\n        catch (error) {\n            return {\n                success: false,\n                message: 'Podfile is not readable',\n                error: error instanceof Error ? error.message : String(error)\n            };\n        }\n        return {\n            success: true,\n            message: 'iOS project is ready for configuration'\n        };\n    }\n    /**\n     * Gets information about the current Podfile configuration\n     */\n    getPodfileInfo(projectRoot) {\n        const podfilePath = this.findPodfile(projectRoot);\n        if (!podfilePath) {\n            return { exists: false };\n        }\n        try {\n            const content = fs.readFileSync(podfilePath, 'utf8');\n            // Extract existing pod declarations\n            const podRegex = /pod\\s+['\"]([^'\"]+)['\"][^\\n]*/g;\n            const pods = [];\n            let match;\n            while ((match = podRegex.exec(content)) !== null) {\n                pods.push(match[1]);\n            }\n            return {\n                exists: true,\n                path: podfilePath,\n                content,\n                pods\n            };\n        }\n        catch (error) {\n            return { exists: true, path: podfilePath };\n        }\n    }\n}\n/**\n * Convenience function to configure Podfile\n */\nexport function configurePodfile(projectRoot, moduleConfig) {\n    const manager = new IOSConfigManager();\n    return manager.configurePodfile(projectRoot, moduleConfig);\n}\n/**\n * Convenience function to validate iOS project\n */\nexport function validateIOSProject(projectRoot) {\n    const manager = new IOSConfigManager();\n    return manager.validateIOSProject(projectRoot);\n}\n"],"mappings":"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","ignoreList":[]}
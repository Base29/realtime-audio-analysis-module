{"version":3,"names":["fs","path","PathResolver","constructor","_defineProperty","detectModuleLocation","projectRoot","moduleName","targetModule","MODULE_NAME","possiblePaths","join","dirname","modulePath","result","validateModulePath","success","error","existsSync","stats","statSync","isDirectory","androidProjectPath","androidValidation","validateAndroidProjectStructure","iosProjectPath","iosValidation","validateIosProjectStructure","isValid","undefined","Error","message","String","androidPath","buildGradlePath","srcMainPath","javaPath","kotlinPath","iosPath","files","readdirSync","hasIosFiles","some","file","endsWith","resolveModulePath","pathInput","resolvedPath","isAbsolute","startsWith","resolve","createModuleConfig","pathResult","platform","name","packageName","className","detectModule","resolver"],"sources":["path-resolver.js"],"sourcesContent":["import * as fs from 'fs';\nimport * as path from 'path';\nexport class PathResolver {\n    MODULE_NAME = 'react-native-realtime-audio-analysis';\n    /**\n     * Detects the installation location of the module\n     * Checks common locations: node_modules, local_modules, and absolute paths\n     */\n    detectModuleLocation(projectRoot, moduleName) {\n        const targetModule = moduleName || this.MODULE_NAME;\n        // Define possible installation locations in order of preference\n        const possiblePaths = [\n            // node_modules (standard npm install)\n            path.join(projectRoot, 'node_modules', targetModule),\n            // local_modules (local development)\n            path.join(projectRoot, 'local_modules', targetModule),\n            // Direct sibling directory (common for local development)\n            path.join(path.dirname(projectRoot), targetModule),\n            // Current directory (if running from within the module)\n            projectRoot\n        ];\n        for (const modulePath of possiblePaths) {\n            const result = this.validateModulePath(modulePath);\n            if (result.success) {\n                return result;\n            }\n        }\n        return {\n            success: false,\n            error: `Module '${targetModule}' not found in any of the expected locations: ${possiblePaths.join(', ')}`\n        };\n    }\n    /**\n     * Validates that a given path contains a valid React Native module\n     * with the required Android project structure\n     */\n    validateModulePath(modulePath) {\n        try {\n            // Check if the module directory exists\n            if (!fs.existsSync(modulePath)) {\n                return {\n                    success: false,\n                    error: `Module path does not exist: ${modulePath}`\n                };\n            }\n            // Check if it's a directory\n            const stats = fs.statSync(modulePath);\n            if (!stats.isDirectory()) {\n                return {\n                    success: false,\n                    error: `Module path is not a directory: ${modulePath}`\n                };\n            }\n            // Validate Android project structure\n            const androidProjectPath = path.join(modulePath, 'android');\n            const androidValidation = this.validateAndroidProjectStructure(androidProjectPath);\n            // Validate iOS project structure\n            const iosProjectPath = path.join(modulePath, 'ios');\n            const iosValidation = this.validateIosProjectStructure(iosProjectPath);\n            // At least one platform must be valid\n            if (!androidValidation.isValid && !iosValidation.isValid) {\n                return {\n                    success: false,\n                    error: `No valid platform projects found. Android: ${androidValidation.error}, iOS: ${iosValidation.error}`\n                };\n            }\n            return {\n                success: true,\n                modulePath,\n                androidProjectPath: androidValidation.isValid ? androidProjectPath : undefined,\n                iosProjectPath: iosValidation.isValid ? iosProjectPath : undefined\n            };\n        }\n        catch (error) {\n            return {\n                success: false,\n                error: `Error validating module path: ${error instanceof Error ? error.message : String(error)}`\n            };\n        }\n    }\n    /**\n     * Validates Android project structure exists and contains required files\n     */\n    validateAndroidProjectStructure(androidPath) {\n        if (!fs.existsSync(androidPath)) {\n            return { isValid: false, error: 'Android directory not found' };\n        }\n        // Check for build.gradle file\n        const buildGradlePath = path.join(androidPath, 'build.gradle');\n        if (!fs.existsSync(buildGradlePath)) {\n            return { isValid: false, error: 'Android build.gradle not found' };\n        }\n        // Check for source directory structure\n        const srcMainPath = path.join(androidPath, 'src', 'main');\n        if (!fs.existsSync(srcMainPath)) {\n            return { isValid: false, error: 'Android src/main directory not found' };\n        }\n        // Check for Java/Kotlin source files\n        const javaPath = path.join(srcMainPath, 'java');\n        const kotlinPath = path.join(srcMainPath, 'kotlin');\n        if (!fs.existsSync(javaPath) && !fs.existsSync(kotlinPath)) {\n            return { isValid: false, error: 'No Java or Kotlin source directories found' };\n        }\n        return { isValid: true };\n    }\n    /**\n     * Validates iOS project structure exists and contains required files\n     */\n    validateIosProjectStructure(iosPath) {\n        if (!fs.existsSync(iosPath)) {\n            return { isValid: false, error: 'iOS directory not found' };\n        }\n        // Check for at least one iOS source file (.m, .swift, .h)\n        const files = fs.readdirSync(iosPath);\n        const hasIosFiles = files.some(file => file.endsWith('.m') ||\n            file.endsWith('.swift') ||\n            file.endsWith('.h') ||\n            file.endsWith('.mm'));\n        if (!hasIosFiles) {\n            return { isValid: false, error: 'No iOS source files found' };\n        }\n        return { isValid: true };\n    }\n    /**\n     * Resolves the absolute path for different installation types\n     */\n    resolveModulePath(projectRoot, pathInput) {\n        let resolvedPath;\n        // Handle different path formats\n        if (path.isAbsolute(pathInput)) {\n            // Absolute path\n            resolvedPath = pathInput;\n        }\n        else if (pathInput.startsWith('./') || pathInput.startsWith('../')) {\n            // Relative path\n            resolvedPath = path.resolve(projectRoot, pathInput);\n        }\n        else {\n            // Assume it's a module name, try to detect location\n            return this.detectModuleLocation(projectRoot, pathInput);\n        }\n        return this.validateModulePath(resolvedPath);\n    }\n    /**\n     * Creates a module configuration object from a resolved path\n     */\n    createModuleConfig(pathResult) {\n        if (!pathResult.success || !pathResult.modulePath) {\n            return null;\n        }\n        // Determine platform support\n        let platform = 'both';\n        if (pathResult.androidProjectPath && !pathResult.iosProjectPath) {\n            platform = 'android';\n        }\n        else if (pathResult.iosProjectPath && !pathResult.androidProjectPath) {\n            platform = 'ios';\n        }\n        return {\n            name: this.MODULE_NAME,\n            packageName: 'com.realtimeaudio',\n            className: 'RealtimeAudioAnalyzerPackage',\n            modulePath: pathResult.modulePath,\n            platform\n        };\n    }\n}\n/**\n * Convenience function to detect and validate module installation\n */\nexport function detectModule(projectRoot, moduleName) {\n    const resolver = new PathResolver();\n    return resolver.detectModuleLocation(projectRoot, moduleName);\n}\n/**\n * Convenience function to resolve a module path from various input formats\n */\nexport function resolveModulePath(projectRoot, pathInput) {\n    const resolver = new PathResolver();\n    return resolver.resolveModulePath(projectRoot, pathInput);\n}\n"],"mappings":"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","ignoreList":[]}
{"version":3,"names":["fs","path","AndroidConfigManager","configureMainApplication","projectRoot","moduleConfig","mainAppPath","findMainApplicationFile","success","message","error","isKotlin","endsWith","content","readFileSync","isAlreadyConfigured","modifiedFiles","modifiedContent","modifyMainApplicationContent","backupPath","writeFileSync","basename","Error","String","androidAppPath","join","existsSync","findMainApp","dir","files","readdirSync","file","filePath","stat","statSync","isDirectory","result","importPattern","RegExp","packageName","className","packagePattern","test","addImportStatement","addPackageToGetPackages","_isKotlin","importStatement","importRegex","imports","match","length","lastImport","lastImportIndex","lastIndexOf","insertIndex","slice","packageRegex","packageMatch","packageIndex","indexOf","getPackagesRegex","packagesContent","trim","packageInstance","replacement","replace","alternativeRegex","altMatch","configureBuildFiles","settingsResult","configureSettingsGradle","push","buildResult","configureAppBuildGradle","settingsPath","projectName","name","includes","androidDir","relativePath","relative","modulePath","includeStatement","projectStatement","buildGradlePath","dependencyStatement","dependenciesRegex","dependenciesContent","newDependenciesContent","manager"],"sources":["android-config.ts"],"sourcesContent":["import * as fs from 'fs';\nimport * as path from 'path';\nimport { ModuleConfig } from './path-resolver';\n\nexport interface AndroidConfigResult {\n  success: boolean;\n  message: string;\n  error?: string;\n  modifiedFiles?: string[];\n}\n\nexport class AndroidConfigManager {\n  /**\n   * Configures MainApplication file to register the native module package\n   */\n  public configureMainApplication(\n    projectRoot: string, \n    moduleConfig: ModuleConfig\n  ): AndroidConfigResult {\n    try {\n      const mainAppPath = this.findMainApplicationFile(projectRoot);\n      if (!mainAppPath) {\n        return {\n          success: false,\n          message: 'MainApplication file not found',\n          error: 'Could not locate MainApplication.kt or MainApplication.java file'\n        };\n      }\n\n      const isKotlin = mainAppPath.endsWith('.kt');\n      const content = fs.readFileSync(mainAppPath, 'utf8');\n      \n      // Check if already configured\n      if (this.isAlreadyConfigured(content, moduleConfig)) {\n        return {\n          success: true,\n          message: 'MainApplication already configured',\n          modifiedFiles: []\n        };\n      }\n\n      const modifiedContent = this.modifyMainApplicationContent(content, moduleConfig, isKotlin);\n      \n      // Create backup\n      const backupPath = `${mainAppPath}.backup`;\n      fs.writeFileSync(backupPath, content);\n      \n      // Write modified content\n      fs.writeFileSync(mainAppPath, modifiedContent);\n\n      return {\n        success: true,\n        message: `Successfully configured ${path.basename(mainAppPath)}`,\n        modifiedFiles: [mainAppPath]\n      };\n\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to configure MainApplication',\n        error: error instanceof Error ? error.message : String(error)\n      };\n    }\n  }\n\n  /**\n   * Finds the MainApplication file in the Android project\n   */\n  private findMainApplicationFile(projectRoot: string): string | null {\n    const androidAppPath = path.join(projectRoot, 'android', 'app', 'src', 'main', 'java');\n    \n    if (!fs.existsSync(androidAppPath)) {\n      return null;\n    }\n\n    // Recursively search for MainApplication files\n    const findMainApp = (dir: string): string | null => {\n      const files = fs.readdirSync(dir);\n      \n      for (const file of files) {\n        const filePath = path.join(dir, file);\n        const stat = fs.statSync(filePath);\n        \n        if (stat.isDirectory()) {\n          const result = findMainApp(filePath);\n          if (result) return result;\n        } else if (file === 'MainApplication.kt' || file === 'MainApplication.java') {\n          return filePath;\n        }\n      }\n      \n      return null;\n    };\n\n    return findMainApp(androidAppPath);\n  }\n\n  /**\n   * Checks if the MainApplication is already configured with the module\n   */\n  private isAlreadyConfigured(content: string, moduleConfig: ModuleConfig): boolean {\n    const importPattern = new RegExp(`import\\\\s+${moduleConfig.packageName}\\\\.${moduleConfig.className}`);\n    const packagePattern = new RegExp(`${moduleConfig.className}\\\\(\\\\)`);\n    \n    return importPattern.test(content) && packagePattern.test(content);\n  }\n\n  /**\n   * Modifies the MainApplication content to include the module\n   */\n  private modifyMainApplicationContent(\n    content: string, \n    moduleConfig: ModuleConfig, \n    isKotlin: boolean\n  ): string {\n    let modifiedContent = content;\n\n    // Add import statement\n    modifiedContent = this.addImportStatement(modifiedContent, moduleConfig, isKotlin);\n    \n    // Add package to getPackages method\n    modifiedContent = this.addPackageToGetPackages(modifiedContent, moduleConfig, isKotlin);\n\n    return modifiedContent;\n  }\n\n  /**\n   * Adds the import statement for the module package\n   */\n  private addImportStatement(\n    content: string, \n    moduleConfig: ModuleConfig, \n    _isKotlin: boolean\n  ): string {\n    const importStatement = `import ${moduleConfig.packageName}.${moduleConfig.className}`;\n    \n    // Find the last import statement\n    const importRegex = /import\\s+[^;]+[;\\n]/g;\n    const imports = content.match(importRegex);\n    \n    if (imports && imports.length > 0) {\n      const lastImport = imports[imports.length - 1];\n      const lastImportIndex = content.lastIndexOf(lastImport);\n      const insertIndex = lastImportIndex + lastImport.length;\n      \n      return content.slice(0, insertIndex) + \n             importStatement + '\\n' + \n             content.slice(insertIndex);\n    } else {\n      // If no imports found, add after package declaration\n      const packageRegex = /package\\s+[^;]+[;\\n]/;\n      const packageMatch = content.match(packageRegex);\n      \n      if (packageMatch) {\n        const packageIndex = content.indexOf(packageMatch[0]) + packageMatch[0].length;\n        return content.slice(0, packageIndex) + \n               '\\n' + importStatement + '\\n' + \n               content.slice(packageIndex);\n      }\n    }\n    \n    return content;\n  }\n\n  /**\n   * Adds the package to the getPackages method\n   */\n  private addPackageToGetPackages(\n    content: string, \n    moduleConfig: ModuleConfig, \n    _isKotlin: boolean\n  ): string {\n    // Find the getPackages method\n    const getPackagesRegex = /override\\s+fun\\s+getPackages\\(\\)[\\s\\S]*?return\\s+Arrays\\.asList\\(([\\s\\S]*?)\\)/;\n    const match = content.match(getPackagesRegex);\n    \n    if (match) {\n      const packagesContent = match[1].trim();\n      const packageInstance = `${moduleConfig.className}()`;\n      \n      // Check if packages list is empty or has content\n      if (packagesContent === '') {\n        // Empty list\n        const replacement = match[0].replace(\n          /return\\s+Arrays\\.asList\\(\\s*\\)/,\n          `return Arrays.asList(\\n        ${packageInstance}\\n      )`\n        );\n        return content.replace(match[0], replacement);\n      } else {\n        // Add to existing list\n        const replacement = match[0].replace(\n          packagesContent,\n          `${packagesContent},\\n        ${packageInstance}`\n        );\n        return content.replace(match[0], replacement);\n      }\n    }\n\n    // If getPackages method not found in expected format, try alternative patterns\n    const alternativeRegex = /getPackages\\(\\)[\\s\\S]*?return\\s+Arrays\\.asList\\(([\\s\\S]*?)\\)/;\n    const altMatch = content.match(alternativeRegex);\n    \n    if (altMatch) {\n      const packagesContent = altMatch[1].trim();\n      const packageInstance = `${moduleConfig.className}()`;\n      \n      if (packagesContent === '') {\n        const replacement = altMatch[0].replace(\n          /return\\s+Arrays\\.asList\\(\\s*\\)/,\n          `return Arrays.asList(\\n        ${packageInstance}\\n      )`\n        );\n        return content.replace(altMatch[0], replacement);\n      } else {\n        const replacement = altMatch[0].replace(\n          packagesContent,\n          `${packagesContent},\\n        ${packageInstance}`\n        );\n        return content.replace(altMatch[0], replacement);\n      }\n    }\n\n    return content;\n  }\n\n  /**\n   * Configures Android build files (settings.gradle and app/build.gradle)\n   */\n  public configureBuildFiles(\n    projectRoot: string, \n    moduleConfig: ModuleConfig\n  ): AndroidConfigResult {\n    try {\n      const modifiedFiles: string[] = [];\n      \n      // Configure settings.gradle\n      const settingsResult = this.configureSettingsGradle(projectRoot, moduleConfig);\n      if (!settingsResult.success) {\n        return settingsResult;\n      }\n      if (settingsResult.modifiedFiles) {\n        modifiedFiles.push(...settingsResult.modifiedFiles);\n      }\n\n      // Configure app/build.gradle\n      const buildResult = this.configureAppBuildGradle(projectRoot, moduleConfig);\n      if (!buildResult.success) {\n        return buildResult;\n      }\n      if (buildResult.modifiedFiles) {\n        modifiedFiles.push(...buildResult.modifiedFiles);\n      }\n\n      return {\n        success: true,\n        message: 'Successfully configured Android build files',\n        modifiedFiles\n      };\n\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to configure Android build files',\n        error: error instanceof Error ? error.message : String(error)\n      };\n    }\n  }\n\n  /**\n   * Configures settings.gradle to include the module project\n   */\n  private configureSettingsGradle(\n    projectRoot: string, \n    moduleConfig: ModuleConfig\n  ): AndroidConfigResult {\n    const settingsPath = path.join(projectRoot, 'android', 'settings.gradle');\n    \n    if (!fs.existsSync(settingsPath)) {\n      return {\n        success: false,\n        message: 'settings.gradle not found',\n        error: `File not found: ${settingsPath}`\n      };\n    }\n\n    const content = fs.readFileSync(settingsPath, 'utf8');\n    const projectName = `:${moduleConfig.name}`;\n    \n    // Check if already configured\n    if (content.includes(projectName)) {\n      return {\n        success: true,\n        message: 'settings.gradle already configured',\n        modifiedFiles: []\n      };\n    }\n\n    // Calculate relative path from android directory to module\n    const androidDir = path.join(projectRoot, 'android');\n    const relativePath = path.relative(androidDir, path.join(moduleConfig.modulePath, 'android'));\n    \n    // Add project inclusion\n    const includeStatement = `include '${projectName}'`;\n    const projectStatement = `project('${projectName}').projectDir = new File('${relativePath}')`;\n    \n    const modifiedContent = content + '\\n' + includeStatement + '\\n' + projectStatement + '\\n';\n    \n    // Create backup\n    const backupPath = `${settingsPath}.backup`;\n    fs.writeFileSync(backupPath, content);\n    \n    // Write modified content\n    fs.writeFileSync(settingsPath, modifiedContent);\n\n    return {\n      success: true,\n      message: 'Successfully configured settings.gradle',\n      modifiedFiles: [settingsPath]\n    };\n  }\n\n  /**\n   * Configures app/build.gradle to add the module dependency\n   */\n  private configureAppBuildGradle(\n    projectRoot: string, \n    moduleConfig: ModuleConfig\n  ): AndroidConfigResult {\n    const buildGradlePath = path.join(projectRoot, 'android', 'app', 'build.gradle');\n    \n    if (!fs.existsSync(buildGradlePath)) {\n      return {\n        success: false,\n        message: 'app/build.gradle not found',\n        error: `File not found: ${buildGradlePath}`\n      };\n    }\n\n    const content = fs.readFileSync(buildGradlePath, 'utf8');\n    const projectName = `:${moduleConfig.name}`;\n    const dependencyStatement = `implementation project('${projectName}')`;\n    \n    // Check if already configured\n    if (content.includes(dependencyStatement)) {\n      return {\n        success: true,\n        message: 'app/build.gradle already configured',\n        modifiedFiles: []\n      };\n    }\n\n    // Find dependencies block\n    const dependenciesRegex = /dependencies\\s*\\{([\\s\\S]*?)\\n\\}/;\n    const match = content.match(dependenciesRegex);\n    \n    if (!match) {\n      return {\n        success: false,\n        message: 'Dependencies block not found in app/build.gradle',\n        error: 'Could not locate dependencies block'\n      };\n    }\n\n    // Add dependency to the dependencies block\n    const dependenciesContent = match[1];\n    const newDependenciesContent = dependenciesContent + `\\n    ${dependencyStatement}`;\n    const modifiedContent = content.replace(\n      match[0],\n      `dependencies {${newDependenciesContent}\\n}`\n    );\n    \n    // Create backup\n    const backupPath = `${buildGradlePath}.backup`;\n    fs.writeFileSync(backupPath, content);\n    \n    // Write modified content\n    fs.writeFileSync(buildGradlePath, modifiedContent);\n\n    return {\n      success: true,\n      message: 'Successfully configured app/build.gradle',\n      modifiedFiles: [buildGradlePath]\n    };\n  }\n}\n\n/**\n * Convenience function to configure MainApplication\n */\nexport function configureMainApplication(\n  projectRoot: string, \n  moduleConfig: ModuleConfig\n): AndroidConfigResult {\n  const manager = new AndroidConfigManager();\n  return manager.configureMainApplication(projectRoot, moduleConfig);\n}\n\n/**\n * Convenience function to configure Android build files\n */\nexport function configureBuildFiles(\n  projectRoot: string, \n  moduleConfig: ModuleConfig\n): AndroidConfigResult {\n  const manager = new AndroidConfigManager();\n  return manager.configureBuildFiles(projectRoot, moduleConfig);\n}"],"mappings":"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","ignoreList":[]}
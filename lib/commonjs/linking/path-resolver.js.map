{"version":3,"names":["fs","_interopRequireWildcard","require","path","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_defineProperty","_toPropertyKey","value","enumerable","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","PathResolver","constructor","detectModuleLocation","projectRoot","moduleName","targetModule","MODULE_NAME","possiblePaths","join","dirname","modulePath","result","validateModulePath","success","error","existsSync","stats","statSync","isDirectory","androidProjectPath","androidValidation","validateAndroidProjectStructure","iosProjectPath","iosValidation","validateIosProjectStructure","isValid","undefined","Error","message","androidPath","buildGradlePath","srcMainPath","javaPath","kotlinPath","iosPath","files","readdirSync","hasIosFiles","some","file","endsWith","resolveModulePath","pathInput","resolvedPath","isAbsolute","startsWith","resolve","createModuleConfig","pathResult","platform","name","packageName","className","exports","detectModule","resolver"],"sources":["path-resolver.ts"],"sourcesContent":["import * as fs from 'fs';\nimport * as path from 'path';\n\nexport interface ModuleConfig {\n  name: string;\n  packageName: string;\n  className: string;\n  modulePath: string;\n  platform: 'android' | 'ios' | 'both';\n}\n\nexport interface PathResolutionResult {\n  success: boolean;\n  modulePath?: string;\n  androidProjectPath?: string;\n  iosProjectPath?: string;\n  error?: string;\n}\n\nexport class PathResolver {\n  private readonly MODULE_NAME = 'react-native-realtime-audio-analysis';\n  \n  /**\n   * Detects the installation location of the module\n   * Checks common locations: node_modules, local_modules, and absolute paths\n   */\n  public detectModuleLocation(projectRoot: string, moduleName?: string): PathResolutionResult {\n    const targetModule = moduleName || this.MODULE_NAME;\n    \n    // Define possible installation locations in order of preference\n    const possiblePaths = [\n      // node_modules (standard npm install)\n      path.join(projectRoot, 'node_modules', targetModule),\n      // local_modules (local development)\n      path.join(projectRoot, 'local_modules', targetModule),\n      // Direct sibling directory (common for local development)\n      path.join(path.dirname(projectRoot), targetModule),\n      // Current directory (if running from within the module)\n      projectRoot\n    ];\n\n    for (const modulePath of possiblePaths) {\n      const result = this.validateModulePath(modulePath);\n      if (result.success) {\n        return result;\n      }\n    }\n\n    return {\n      success: false,\n      error: `Module '${targetModule}' not found in any of the expected locations: ${possiblePaths.join(', ')}`\n    };\n  }\n\n  /**\n   * Validates that a given path contains a valid React Native module\n   * with the required Android project structure\n   */\n  public validateModulePath(modulePath: string): PathResolutionResult {\n    try {\n      // Check if the module directory exists\n      if (!fs.existsSync(modulePath)) {\n        return {\n          success: false,\n          error: `Module path does not exist: ${modulePath}`\n        };\n      }\n\n      // Check if it's a directory\n      const stats = fs.statSync(modulePath);\n      if (!stats.isDirectory()) {\n        return {\n          success: false,\n          error: `Module path is not a directory: ${modulePath}`\n        };\n      }\n\n      // Validate Android project structure\n      const androidProjectPath = path.join(modulePath, 'android');\n      const androidValidation = this.validateAndroidProjectStructure(androidProjectPath);\n      \n      // Validate iOS project structure\n      const iosProjectPath = path.join(modulePath, 'ios');\n      const iosValidation = this.validateIosProjectStructure(iosProjectPath);\n\n      // At least one platform must be valid\n      if (!androidValidation.isValid && !iosValidation.isValid) {\n        return {\n          success: false,\n          error: `No valid platform projects found. Android: ${androidValidation.error}, iOS: ${iosValidation.error}`\n        };\n      }\n\n      return {\n        success: true,\n        modulePath,\n        androidProjectPath: androidValidation.isValid ? androidProjectPath : undefined,\n        iosProjectPath: iosValidation.isValid ? iosProjectPath : undefined\n      };\n\n    } catch (error) {\n      return {\n        success: false,\n        error: `Error validating module path: ${error instanceof Error ? error.message : String(error)}`\n      };\n    }\n  }\n\n  /**\n   * Validates Android project structure exists and contains required files\n   */\n  private validateAndroidProjectStructure(androidPath: string): { isValid: boolean; error?: string } {\n    if (!fs.existsSync(androidPath)) {\n      return { isValid: false, error: 'Android directory not found' };\n    }\n\n    // Check for build.gradle file\n    const buildGradlePath = path.join(androidPath, 'build.gradle');\n    if (!fs.existsSync(buildGradlePath)) {\n      return { isValid: false, error: 'Android build.gradle not found' };\n    }\n\n    // Check for source directory structure\n    const srcMainPath = path.join(androidPath, 'src', 'main');\n    if (!fs.existsSync(srcMainPath)) {\n      return { isValid: false, error: 'Android src/main directory not found' };\n    }\n\n    // Check for Java/Kotlin source files\n    const javaPath = path.join(srcMainPath, 'java');\n    const kotlinPath = path.join(srcMainPath, 'kotlin');\n    \n    if (!fs.existsSync(javaPath) && !fs.existsSync(kotlinPath)) {\n      return { isValid: false, error: 'No Java or Kotlin source directories found' };\n    }\n\n    return { isValid: true };\n  }\n\n  /**\n   * Validates iOS project structure exists and contains required files\n   */\n  private validateIosProjectStructure(iosPath: string): { isValid: boolean; error?: string } {\n    if (!fs.existsSync(iosPath)) {\n      return { isValid: false, error: 'iOS directory not found' };\n    }\n\n    // Check for at least one iOS source file (.m, .swift, .h)\n    const files = fs.readdirSync(iosPath);\n    const hasIosFiles = files.some(file => \n      file.endsWith('.m') || \n      file.endsWith('.swift') || \n      file.endsWith('.h') || \n      file.endsWith('.mm')\n    );\n\n    if (!hasIosFiles) {\n      return { isValid: false, error: 'No iOS source files found' };\n    }\n\n    return { isValid: true };\n  }\n\n  /**\n   * Resolves the absolute path for different installation types\n   */\n  public resolveModulePath(projectRoot: string, pathInput: string): PathResolutionResult {\n    let resolvedPath: string;\n\n    // Handle different path formats\n    if (path.isAbsolute(pathInput)) {\n      // Absolute path\n      resolvedPath = pathInput;\n    } else if (pathInput.startsWith('./') || pathInput.startsWith('../')) {\n      // Relative path\n      resolvedPath = path.resolve(projectRoot, pathInput);\n    } else {\n      // Assume it's a module name, try to detect location\n      return this.detectModuleLocation(projectRoot, pathInput);\n    }\n\n    return this.validateModulePath(resolvedPath);\n  }\n\n  /**\n   * Creates a module configuration object from a resolved path\n   */\n  public createModuleConfig(pathResult: PathResolutionResult): ModuleConfig | null {\n    if (!pathResult.success || !pathResult.modulePath) {\n      return null;\n    }\n\n    // Determine platform support\n    let platform: 'android' | 'ios' | 'both' = 'both';\n    if (pathResult.androidProjectPath && !pathResult.iosProjectPath) {\n      platform = 'android';\n    } else if (pathResult.iosProjectPath && !pathResult.androidProjectPath) {\n      platform = 'ios';\n    }\n\n    return {\n      name: this.MODULE_NAME,\n      packageName: 'com.realtimeaudio',\n      className: 'RealtimeAudioAnalyzerPackage',\n      modulePath: pathResult.modulePath,\n      platform\n    };\n  }\n}\n\n/**\n * Convenience function to detect and validate module installation\n */\nexport function detectModule(projectRoot: string, moduleName?: string): PathResolutionResult {\n  const resolver = new PathResolver();\n  return resolver.detectModuleLocation(projectRoot, moduleName);\n}\n\n/**\n * Convenience function to resolve a module path from various input formats\n */\nexport function resolveModulePath(projectRoot: string, pathInput: string): PathResolutionResult {\n  const resolver = new PathResolver();\n  return resolver.resolveModulePath(projectRoot, pathInput);\n}"],"mappings":"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","ignoreList":[]}